ö
dC:\Users\nerod\Documents\GitHub\SonarLint\owasp10.test\Controllers\BrokenAcccessControlController.cs
	namespace 	
owasp10
 
. 
test 
. 
Controllers "
;" #
[ 
ApiController 
] 
[ 
Route 
( 
$str 
) 
] 
public 
class *
BrokenAcccessControlController +
:, -
ControllerBase. <
{		 
List

 
<

 	
Person

	 
>

 
persons

 
=

 
new

 
(

 
)

  
{ 
new 
( 
) 
{ 
Id 
= 
$num 
, 
Name 
= 
$str %
,% &
Age' *
=+ ,
$num- /
,/ 0
Address1 8
=9 :
$str; C
}D E
,E F
new 
( 
) 
{ 
Id 
= 
$num 
, 
Name 
= 
$str %
,% &
Age' *
=+ ,
$num- /
,/ 0
Address1 8
=9 :
$str; C
}D E
,E F
new 
( 
) 
{ 
Id 
= 
$num 
, 
Name 
= 
$str '
,' (
Age) ,
=- .
$num/ 1
,1 2
Address3 :
=; <
$str= E
}F G
,G H
new 
( 
) 
{ 
Id 
= 
$num 
, 
Name 
= 
$str &
,& '
Age( +
=, -
$num. 0
,0 1
Address2 9
=: ;
$str< D
}E F
,F G
new 
( 
) 
{ 
Id 
= 
$num 
, 
Name 
= 
$str $
,$ %
Age& )
=* +
$num, .
,. /
Address0 7
=8 9
$str: B
}C D
} 
; 
public 
*
BrokenAcccessControlController )
() *
)* +
{ 
} 
[ 
HttpGet 
] 
public 

IActionResult 
AccountInfo $
($ %
[% &
	FromQuery& /
]/ 0
int1 4
id5 7
)7 8
{ 
return 
Ok 
( 
persons 
. 
Where 
(  
p  !
=>" $
p% &
.& '
Age' *
==+ -
id. 0
)0 1
.1 2
FirstOrDefault2 @
(@ A
)A B
)B C
;C D
} 
[ 
HttpGet 
] 
public   

IActionResult   
AdminAccountInfo   )
(  ) *
)  * +
{!! 
return"" 
Ok"" 
("" 
persons"" 
."" 
Select""  
(""  !
p""! "
=>""# %
new""& )
{""* +
p"", -
.""- .
Id"". 0
,""0 1
p""2 3
.""3 4
Name""4 8
,""8 9
p"": ;
.""; <
Age""< ?
,""? @
p""A B
.""B C
Address""C J
}""K L
)""L M
)""M N
;""N O
}## 
}$$ –
eC:\Users\nerod\Documents\GitHub\SonarLint\owasp10.test\Controllers\CryptographicFailuresController.cs
	namespace 	
owasp10
 
. 
test 
. 
Controllers "
;" #
[ 
ApiController 
] 
[ 
Route 
( 
$str 
) 
] 
public 
class +
CryptographicFailuresController ,
:- .
ControllerBase/ =
{		 
public

 
+
CryptographicFailuresController

 *
(

* +
)

+ ,
{ 
} 
public 

IActionResult 
Sha1 
( 
[ 
	FromQuery (
]( )
string* 0
data1 5
)5 6
{ 
StringBuilder 
sb 
= 
new 
( 
)  
;  !
byte 
[ 
] 
hash 
= 
System 
. 
Security %
.% &
Cryptography& 2
.2 3
SHA13 7
.7 8
Create8 >
(> ?
)? @
.@ A
ComputeHashA L
(L M
EncodingM U
.U V
UTF8V Z
.Z [
GetBytes[ c
(c d
datad h
)h i
)i j
;j k
foreach 
( 
byte 
b 
in 
hash 
)  
{ 	
sb 
. 
Append 
( 
b 
. 
ToString  
(  !
$str! %
)% &
)& '
;' (
} 	
return 
Ok 
( 
sb 
. 
ToString 
( 
) 
)  
;  !
} 
public 

IActionResult 
Sha256 
(  
[  !
	FromQuery! *
]* +
string, 2
data3 7
)7 8
{ 
StringBuilder 
sb 
= 
new 
( 
)  
;  !
byte 
[ 
] 
hash 
= 
System 
. 
Security %
.% &
Cryptography& 2
.2 3
SHA2563 9
.9 :
Create: @
(@ A
)A B
.B C
ComputeHashC N
(N O
EncodingO W
.W X
UTF8X \
.\ ]
GetBytes] e
(e f
dataf j
)j k
)k l
;l m
return!! 
Ok!! 
(!! 
BitConverter!! 
.!! 
ToString!! '
(!!' (
hash!!( ,
)!!, -
.!!- .
Replace!!. 5
(!!5 6
$str!!6 9
,!!9 :
$str!!; =
)!!= >
.!!> ?
ToLower!!? F
(!!F G
)!!G H
)!!H I
;!!I J
}"" 
}$$ £
YC:\Users\nerod\Documents\GitHub\SonarLint\owasp10.test\Controllers\InjectionController.cs
	namespace 	
owasp10
 
. 
test 
. 
Controllers "
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public 

class 
InjectionController $
:% &
ControllerBase' 5
{		 
public

 
InjectionController

 "
(

" #
)

# $
{ 	
} 	
[ 	
HttpGet	 
] 
public 
IActionResult 
SqlInjection )
() *
[* +
	FromQuery+ 4
]4 5
int6 9
username: B
)B C
{ 	
string 
connectionString #
=$ %
$str& e
;e f
using 
SqlConnection 

connection  *
=+ ,
new- 0
(0 1
connectionString1 A
)A B
;B C

connection 
. 
Open 
( 
) 
; 

SqlCommand 
command 
=  
new! $
($ %
$"% '
$str' S
{S T
usernameT \
}\ ]
"] ^
,^ _

connection` j
)j k
;k l
SqlDataReader 
reader  
=! "
command# *
.* +
ExecuteReader+ 8
(8 9
)9 :
;: ;
while 
( 
reader 
. 
Read 
( 
)  
)  !
{ 
Console 
. 
	WriteLine !
(! "
reader" (
[( )
$str) 2
]2 3
.3 4
ToString4 <
(< =
)= >
)> ?
;? @
} 
return 
Ok 
( 
) 
; 
} 	
} 
} â
FC:\Users\nerod\Documents\GitHub\SonarLint\owasp10.test\Model\Person.cs
	namespace 	
owasp10
 
. 
test 
. 
Model 
{ 
public 

class 
Person 
{		 
public

 
int

 
Id

 
{

 
get

 
;

 
set

  
;

  !
}

" #
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
=) *
$str+ -
;- .
public 
int 
Age 
{ 
get 
; 
set !
;! "
}# $
public 
string 
Address 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
$str. 0
;0 1
} 
} ñ
AC:\Users\nerod\Documents\GitHub\SonarLint\owasp10.test\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
)  
;  !
var

 
app

 
=

 	
builder


 
.

 
Build

 
(

 
)

 
;

 
if 
( 
app 
. 
Environment 
. 
IsDevelopment !
(! "
)" #
)# $
{ 
app 
. 

UseSwagger 
( 
) 
; 
app 
. 
UseSwaggerUI 
( 
) 
; 
} 
app 
. 
UseHttpsRedirection 
( 
) 
; 
app 
. 
UseAuthorization 
( 
) 
; 
app 
. 
MapControllers 
( 
) 
; 
app 
. 
Run 
( 
) 	
;	 
